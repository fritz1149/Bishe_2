
A有三个密钥：自己的私钥、B的公钥和自己生成的一次性密钥。
B有两个密钥：自己的私钥和A的公钥。

A需要做以下几件事：
对明文邮件X进行MD5运算，得出MD5报文摘要H。
用A的私钥对H进行加密（即数字签名），得出报文鉴别码MAC，把它拼接在明文X后面，得到扩展的邮件（X，MAC）。

使用A自己生成的一次性密钥对扩展的邮件（X，MAC）进行加密。