


B收到加密的扩展的报文后要做以下几件事：
把被加密的一次性密钥和被加密的扩展的报文（X，MAC）分离开。

用B自己的私钥解出A的一次性密钥。

用解出的一次性密钥对报文进行解密，然后分离出明文X和MAC。

用A的公钥对MAC进行解密（即签名核实），得出报文摘要H。
这个报文摘要就是A原先用明文邮件X通过MD5运算生成的那个报文摘要。